---
import PlotFigure from "../components/PlotFigure.astro";
import Layout from "../layouts/Layout.astro";
import * as Plot from "@observablehq/plot";
import penguins from "../assets/penguins.json";
import Header from "../components/Header.astro";

const adelie = penguins.filter(d => d.species === "Adelie");
const chinstrap = penguins.filter(d => d.species === "Chinstrap");
const gentoo = penguins.filter(d => d.species === "Gentoo");
---

<Layout>
  <Header />

  <main class="container">
    <h1 class="title">Penguins par espèce</h1>

    <!-- Select menu -->
    <select id="speciesSelect" class="select-menu">
      <option value="#adelie">Adelie</option>
      <option value="#chinstrap">Chinstrap</option>
      <option value="#gentoo">Gentoo</option>
    </select>

    <div class="slider">
      <section id="adelie" class="slide card">
        <h2>Adelie Penguins</h2>
        <PlotFigure
          options={{
            marks: [Plot.dot(adelie, { x: "culmen_length_mm", y: "culmen_depth_mm", stroke: "species" })],
          }}
        />
        <p class="count">Number of Adelie Penguins: {adelie.length}</p>
      </section>

      <section id="chinstrap" class="slide card">
        <h2>Chinstrap Penguins</h2>
        <PlotFigure
          options={{
            marks: [Plot.dot(chinstrap, { x: "culmen_length_mm", y: "culmen_depth_mm", stroke: "species" })],
          }}
        />
        <p class="count">Number of Chinstrap Penguins: {chinstrap.length}</p>
      </section>

      <section id="gentoo" class="slide card">
        <h2>Gentoo Penguins</h2>
        <PlotFigure
          options={{
            marks: [Plot.dot(gentoo, { x: "culmen_length_mm", y: "culmen_depth_mm", stroke: "species" })],
          }}
        />
        <p class="count">Number of Gentoo Penguins: {gentoo.length}</p>
      </section>
    </div>
  </main>
</Layout>

<script>
  document.querySelector("#speciesSelect")?.addEventListener("change", (evt) => {
    const value = evt.target.value;
    location.hash = value; 
  });
</script>

<style>
  .container {
    padding: 2rem;
    max-width: 1200px;
    margin: auto;
  }

  .title {
    font-size: 2rem;
    font-weight: 700;
    margin-bottom: 1.5rem;
    text-align: center;
    color: #7c3aed;
  }

  /* Select menu stylisé */
  .select-menu {
    display: block;
    margin: 0 auto 2rem auto;
    padding: 0.5rem 1rem;
    border: 2px solid #7c3aed;
    border-radius: 0.5rem;
    font-weight: 600;
    color: #7c3aed;
    background: white;
    cursor: pointer;
  }

  .select-menu:focus {
    outline: none;
    border-color: #a855f7;
  }

  /* Slider */
  .slider {
    display: flex;
    overflow-x: auto;
    scroll-snap-type: x mandatory;
    scroll-behavior: smooth;
    gap: 2rem;
    padding-bottom: 1rem;
  }

  .slide {
    min-width: 100%;
    flex-shrink: 0;
    scroll-snap-align: start;
  }

  /* Carte */
  .card {
    background: white;
    border-radius: 1rem;
    padding: 2rem;
    box-shadow: 0 4px 15px rgba(0,0,0,0.08);
  }

  .card h2 {
    margin-bottom: 1rem;
    font-size: 1.5rem;
    color: #7c3aed;
  }

  .count {
    margin-top: 1rem;
    font-weight: 500;
    color: #a855f7;
  }
</style>
